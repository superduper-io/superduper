(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4256],{43386:function(e,s,a){Promise.resolve().then(a.bind(a,92024))},92024:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return eA}});var r=a(27573),t=a(70007),l=a(70790),n=a(13908),i=a(5772),o=a(412),d=a(45246),c=a(7653),u=a(88146),m=a(93296),p=a(61284),h=a(63130),x=a(36531),v=a(60855);function g(e){let{data:s}=e,a=(0,o.I0)(),t=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels)||[],[l,n]=(0,c.useState)(""),i=async()=>{if(!l){m.ZP.error("Please type a ComputeClass before adding.",{id:"no-input-toast"});return}if(t.includes(l)){m.ZP.error("This ComputeClass is already added! Add a new ComputeClass!");return}try{a((0,v.Lj)([...t,l])),n(""),m.ZP.success("Successfully added!")}catch(e){m.ZP.error("An error occurred. Please reload and try again!")}};return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{className:"block text-sm font-medium leading-6 text-gray-900",children:"Add ComputeClass"}),(0,r.jsx)("input",{type:"text",className:"mt-2 w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",value:l,onChange:e=>{n(e.target.value)},placeholder:"Type ComputeClass here..."}),(0,r.jsx)(x.z,{type:"button",className:"mt-2",onClick:i,children:"Add Now"})]})}var f=a(85688),y=a(4482),j=a(42502),b=a(64303),N=a(4216),w=a(18580);let C=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:s,className:(0,w.cn)("w-full caption-bottom text-sm",a),...t})})});C.displayName="Table";let P=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("thead",{ref:s,className:(0,w.cn)("[&_tr]:border-b",a),...t})});P.displayName="TableHeader";let k=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("tbody",{ref:s,className:(0,w.cn)("[&_tr:last-child]:border-0",a),...t})});k.displayName="TableBody",c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("tfoot",{ref:s,className:(0,w.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...t})}).displayName="TableFooter";let I=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("tr",{ref:s,className:(0,w.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...t})});I.displayName="TableRow";let S=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("th",{ref:s,className:(0,w.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...t})});S.displayName="TableHead";let Z=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("td",{ref:s,className:(0,w.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...t})});Z.displayName="TableCell",c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("caption",{ref:s,className:(0,w.cn)("mt-4 text-sm text-muted-foreground",a),...t})}).displayName="TableCaption";var R=a(95042),E=a(12900),U=a(7109),L=a(74859);let A=(e,s)=>[...e].sort((e,a)=>{for(let[r,t]of Object.entries(s)){let s=parseFloat(e.status.capacity[r]),l=parseFloat(a.status.capacity[r]);if(s!==l)return s<l?"asc"===t?-1:1:"asc"===t?1:-1}return 0});function _(e){let{nodegroupsStatus:s}=e,a=(0,o.v9)(e=>e.environment.environmentLoadedValues),t=(0,o.v9)(e=>{var s;return null==e?void 0:null===(s=e.userInfo)||void 0===s?void 0:s.userInfoLoadedValues}),l=(0,o.I0)(),d=(0,o.v9)(e=>e.nodegroups.nodeLoadedValues),u=(0,o.v9)(e=>e.deploymentName.deploymentNameLoadedValues.name),w=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels)||[];(0,c.useEffect)(()=>{let e=async()=>{try{let e=(await n.Z.get("/webui/apiserver/nodegroups?deployment=".concat(u),{headers:{Accept:"application/json",Authorization:(0,U.Z)(t),superduper_reverse_proxy:L.env.NEXT_PUBLIC_API||a.NEXT_PUBLIC_API}})).data.items.map(e=>e.spec.extraComputeClass&&e.spec.extraComputeClass.length>0?e:{...e,spec:{...e.spec,extraComputeClass:[...new Set([...e.spec.extraComputeClass||[],"base"].filter(Boolean))]},status:{...e.status,reservation:{...e.status.reservation,state:"Idle"}}});l((0,v.NB)({items:e})),l((0,v.Bw)({items:e}))}catch(e){console.error("Error fetching API data:",e),m.ZP.error("Error fetching Node Groups data")}};d||e()},[]);let[_,T]=(0,c.useState)({numCPUs:"asc",numGPUs:"asc",memoryMB:"asc",ephemeralStorageMB:"asc"}),B=(e,s)=>{T(a=>({...a,[e]:s}))},[,V]=(0,c.useState)(),F=()=>V({}),[z,q]=(0,c.useState)(()=>w.length?w[w.length-1]:"base"),[W,O]=(0,c.useState)(0);(0,c.useEffect)(()=>{w.length&&(0===W?(q("base"),O(e=>e+1)):(q(w[w.length-1]),O(e=>e+1)))},[w]),(0,c.useEffect)(()=>{if(console.log("Sorting nodegroups with sortOrder:",_),null==d?void 0:d.items){let e=A(d.items,_);console.log("Sorted items:",e),l((0,v.NB)({items:e})),F()}},[_]);let X=async(e,s)=>{var a,r;(null==e?void 0:e.spec)||(e.spec={}),(null==e?void 0:null===(a=e.spec)||void 0===a?void 0:a.extraComputeClass)||(e.spec.extraComputeClass=[]);let t=(null==e?void 0:null===(r=e.spec)||void 0===r?void 0:r.extraComputeClass)||[];if(t.includes(s)){try{for(let a=e.spec.extraComputeClass.length-1;a>=0;a--)e.spec.extraComputeClass[a]===s&&e.spec.extraComputeClass.splice(a,1);e.spec.exclusiveReservation=null,e.status.reservation.state="Idle";let a=d.items.map(s=>s.name===e.name?e:s);l((0,v.NB)({items:a})),(0,m.ZP)("".concat(s," is removed from ").concat(e.name,"!"),{icon:"❎",id:"updated-toast"}),F()}catch(e){m.ZP.error("An error occurred",{id:"updated-toast"})}return}try{e.spec.extraComputeClass=[...t,s],e.status.reservation.state="Shared";let a=d.items.map(s=>s.name===e.name?e:s);l((0,v.NB)({items:a})),(0,m.ZP)("".concat(s," is added to ").concat(e.name,"!"),{icon:"✅",id:"updated-toast"}),F()}catch(e){m.ZP.error("An error occurred. Please reload and try again!")}},G=async(e,s)=>{var a,r,t;if((null==e?void 0:e.spec)||(e.spec={}),(null==e?void 0:null===(a=e.spec)||void 0===a?void 0:a.extraComputeClass)||(e.spec.extraComputeClass=[]),(null==e?void 0:null===(r=e.spec)||void 0===r?void 0:r.exclusiveReservation)||(e.spec.exclusiveReservation=null),((null==e?void 0:null===(t=e.spec)||void 0===t?void 0:t.exclusiveReservation)||null)===s){try{e.spec.exclusiveReservation=null,e.status.reservation.state="Shared";let a=d.items.map(s=>s.name===e.name?e:s);l((0,v.NB)({items:a})),(0,m.ZP)("".concat(s," is removed from ").concat(e.name,"!"),{icon:"❎",id:"updated-toast"}),F()}catch(e){m.ZP.error("An error occurred",{id:"updated-toast"})}return}try{e.spec.exclusiveReservation=s,e.spec.extraComputeClass=[s],e.status.reservation.state="Exclusive";let a=d.items.map(s=>s.name===e.name?e:s);l((0,v.NB)({items:a})),(0,m.ZP)("".concat(s," is exclusively added to ").concat(e.name,"! It will remove the reserved status from all other nodes."),{icon:"✅",id:"updated-toast"}),F()}catch(e){m.ZP.error("An error occurred. Please reload and try again!")}},M=e=>{try{var s;return"string"==typeof(null==e?void 0:null===(s=e.spec)||void 0===s?void 0:s.exclusiveReservation)&&""!==e.spec.exclusiveReservation.trim()}catch(e){return console.error("Error in reserveDefineDisableOrNot:",e),!1}},Y=(e,s)=>{try{var a,r,t,l,n,i,o,d,c,u;if(null==e?void 0:null===(t=e.spec)||void 0===t?void 0:null===(r=t.extraComputeClass)||void 0===r?void 0:r.includes(null==e?void 0:null===(a=e.spec)||void 0===a?void 0:a.exclusiveReservation)){if((null==e?void 0:null===(u=e.spec)||void 0===u?void 0:u.exclusiveReservation)===s)return!1;return!0}if((null==e?void 0:null===(l=e.spec)||void 0===l?void 0:l.exclusiveReservation)||!(null==e?void 0:null===(i=e.spec)||void 0===i?void 0:null===(n=i.extraComputeClass)||void 0===n?void 0:n.length))return!0;null==e||null===(c=e.spec)||void 0===c||null===(d=c.extraComputeClass)||void 0===d||d.includes(null==e?void 0:null===(o=e.spec)||void 0===o?void 0:o.exclusiveReservation)}catch(e){}return!1},H=(e,s)=>{try{if(1===w.length){m.ZP.error("At least one ComputeClass is required!",{id:"removed-toast"});return}let a=e.items.map(e=>{let a=JSON.parse(JSON.stringify(e));if(a.spec.exclusiveReservation===s&&(a.spec.exclusiveReservation=null),Array.isArray(a.spec.extraComputeClass)){let e=a.spec.extraComputeClass.indexOf(s);-1!==e&&a.spec.extraComputeClass.splice(e,1)}return a});l((0,v.NB)({items:a})),l((0,v.Lj)([...w.filter(e=>e!==s)])),q(w[w.length-1]),F(),(0,m.ZP)("Successfully removed!",{id:"removed-toast"})}catch(e){console.error("Error in handleRemoveComputeClassAndReservation:",e)}},[K,$]=(0,c.useState)("all"),J=e=>{$(e)};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{children:d?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"-ml-4 mt-4 mb-2 bg-white px-4 py-2 sm:px-4",children:(0,r.jsxs)(b.mQ,{defaultValue:z,value:z,onValueChange:e=>q(e),className:"w-full",children:[(0,r.jsx)(b.dr,{children:(0,r.jsxs)("div",{className:"flex",children:[w.map(e=>(0,r.jsxs)(b.SP,{value:e,children:[e," ",(0,r.jsx)(h.Z,{onClick:()=>{H(d,e)},className:"-mr-1 h-4 w-4","aria-hidden":"true"})]},e)),(0,r.jsxs)(R.J2,{children:[(0,r.jsx)(R.xo,{asChild:!0,children:(0,r.jsx)(x.z,{className:"rounded-full",variant:"primary",children:(0,r.jsx)(D,{className:"h-5 w-5"})})}),(0,r.jsxs)(R.yk,{className:"w-80",children:[(0,r.jsx)(p.xp,{asChild:!0,children:(0,r.jsx)(h.Z,{className:"ml-auto -mb-2 h-5 w-5 flex text-gray-400 cursor-pointer hover:text-gray-500","aria-hidden":"true"})}),(0,r.jsxs)("div",{className:"grid gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h4",{className:"font-medium leading-none",children:"Add ComputeClass"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"You can select the compute class for the node later."})]}),(0,r.jsx)("div",{className:"grid gap-2",children:(0,r.jsx)(g,{data:d})})]})]})]})]})}),w.map(e=>(0,r.jsx)(b.nU,{value:e,children:(0,r.jsx)("div",{className:"container mx-auto px-0 py-2 w-full",children:(0,r.jsx)("div",{className:"border rounded-lg overflow-x-auto w-full",children:(0,r.jsxs)(C,{children:[(0,r.jsx)(P,{children:(0,r.jsxs)(I,{children:[(0,r.jsx)(S,{className:"text-center px-1",children:(0,r.jsx)(E.C,{variant:"outline",children:"Reserve"})}),(0,r.jsx)(S,{className:"text-center px-1",children:(0,r.jsx)(E.C,{variant:"outline",children:"Exclusive"})}),(0,r.jsx)(S,{children:(0,r.jsx)(E.C,{variant:"outline",children:"Node Name"})}),(0,r.jsx)(S,{className:"text-center",children:(0,r.jsxs)(j.h_,{children:[(0,r.jsx)(j.$F,{asChild:!0,children:(0,r.jsxs)(x.z,{variant:"ghost",size:"sm",className:"px-0",children:["CPU",(0,r.jsx)(f.jnn,{className:"ml-2 h-4 w-4"})]})}),(0,r.jsx)(j.AW,{align:"end",className:"w-[200px]",children:(0,r.jsxs)(j._x,{value:_.numCPUs,onValueChange:e=>B("numCPUs",e),children:[(0,r.jsx)(j.qB,{value:"asc",children:"Ascending"}),(0,r.jsx)(j.qB,{value:"desc",children:"Descending"})]})})]})}),(0,r.jsx)(S,{className:"text-center",children:(0,r.jsxs)(j.h_,{children:[(0,r.jsx)(j.$F,{asChild:!0,children:(0,r.jsxs)(x.z,{variant:"ghost",size:"sm",className:"px-0",children:["GPU",(0,r.jsx)(f.jnn,{className:"ml-2 h-4 w-4"})]})}),(0,r.jsx)(j.AW,{align:"end",className:"w-[200px]",children:(0,r.jsxs)(j._x,{value:_.numGPUs,onValueChange:e=>B("numGPUs",e),children:[(0,r.jsx)(j.qB,{value:"asc",children:"Ascending"}),(0,r.jsx)(j.qB,{value:"desc",children:"Descending"})]})})]})}),(0,r.jsx)(S,{className:"text-center",children:(0,r.jsxs)(j.h_,{children:[(0,r.jsx)(j.$F,{asChild:!0,children:(0,r.jsxs)(x.z,{variant:"ghost",className:"px-0",size:"sm",children:["RAM",(0,r.jsx)(f.jnn,{className:"ml-2 h-4 w-4"})]})}),(0,r.jsx)(j.AW,{align:"end",className:"w-[200px]",children:(0,r.jsxs)(j._x,{value:_.memoryMB,onValueChange:e=>B("memoryMB",e),children:[(0,r.jsx)(j.qB,{value:"asc",children:"Ascending"}),(0,r.jsx)(j.qB,{value:"desc",children:"Descending"})]})})]})}),(0,r.jsx)(S,{className:"text-center",children:(0,r.jsxs)(j.h_,{children:[(0,r.jsx)(j.$F,{asChild:!0,children:(0,r.jsxs)(x.z,{className:"px-0",variant:"ghost",size:"sm",children:["Storage",(0,r.jsx)(f.jnn,{className:"ml-2 h-4 w-4"})]})}),(0,r.jsx)(j.AW,{align:"end",className:"w-[200px]",children:(0,r.jsxs)(j._x,{value:_.ephemeralStorageMB,onValueChange:e=>B("ephemeralStorageMB",e),children:[(0,r.jsx)(j.qB,{value:"asc",children:"Ascending"}),(0,r.jsx)(j.qB,{value:"desc",children:"Descending"})]})})]})}),(0,r.jsx)(S,{className:"text-center",children:(0,r.jsxs)(j.h_,{children:[(0,r.jsx)(j.$F,{asChild:!0,children:(0,r.jsxs)(x.z,{className:"px-0",variant:"ghost",size:"sm",children:["State",(0,r.jsx)(f.jnn,{className:"ml-2 h-4 w-4"})]})}),(0,r.jsx)(j.AW,{align:"end",className:"w-[200px]",children:(0,r.jsxs)(j._x,{value:K,onValueChange:e=>J(e),children:[(0,r.jsx)(j.qB,{value:"all",children:"Show All"}),(0,r.jsx)(j.qB,{value:"IDLE",children:"IDLE"}),(0,r.jsx)(j.qB,{value:"SHARED",children:"SHARED"}),(0,r.jsx)(j.qB,{value:"EXCLUSIVE",children:"EXCLUSIVE"})]})})]})})]})}),(0,r.jsx)(k,{children:null==d?void 0:d.items.filter(e=>{let s=K.toLowerCase();return"all"===s||!["exclusive","idle","shared"].includes(s)||e.status.reservation.state.toLowerCase()===s}).map((s,a)=>{var t,l,n,i,o,d,c,u,m,p,h,x,v,g,f,j,b;return(0,r.jsxs)(I,{children:[(0,r.jsx)(Z,{className:"text-center",children:(0,r.jsx)(N.X,{id:e,onCheckedChange:()=>{X(s,e)},checked:null==s?void 0:null===(l=s.spec)||void 0===l?void 0:null===(t=l.extraComputeClass)||void 0===t?void 0:t.includes(e),defaultChecked:null==s?void 0:null===(i=s.spec)||void 0===i?void 0:null===(n=i.extraComputeClass)||void 0===n?void 0:n.includes(e),disabled:M(s)})}),(0,r.jsx)(Z,{className:"text-center",children:(0,r.jsx)(N.X,{id:e+e,onCheckedChange:()=>{G(s,e)},checked:(null==s?void 0:null===(o=s.spec)||void 0===o?void 0:o.exclusiveReservation)===e,defaultChecked:(null==s?void 0:null===(d=s.spec)||void 0===d?void 0:d.exclusiveReservation)===e,disabled:Y(s,e)})}),(0,r.jsx)(Z,{children:null==s?void 0:s.name.replace(/\.compute\.internal/g,"")}),(0,r.jsx)(Z,{className:"text-center",children:null==s?void 0:null===(u=s.status)||void 0===u?void 0:null===(c=u.capacity)||void 0===c?void 0:c.numCPUs}),(0,r.jsx)(Z,{className:"text-center",children:null==s?void 0:null===(p=s.status)||void 0===p?void 0:null===(m=p.capacity)||void 0===m?void 0:m.numGPUs}),(0,r.jsxs)(Z,{className:"text-center",children:[null==s?void 0:null===(x=s.status)||void 0===x?void 0:null===(h=x.capacity)||void 0===h?void 0:h.memoryMB,"MB"]}),(0,r.jsxs)(Z,{className:"text-center",children:[(parseInt(String(null==s?void 0:null===(g=s.status)||void 0===g?void 0:null===(v=g.capacity)||void 0===v?void 0:v.ephemeralStorageMB),10)/1024).toFixed(2),"GB"]}),(0,r.jsx)(Z,{className:"text-center",children:(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)("span",{className:"",children:(null==s?void 0:null===(f=s.spec)||void 0===f?void 0:f.exclusiveReservation)?(0,r.jsxs)("dd",{className:"inline-flex items-center rounded-md bg-black px-2 py-1 text-xs font-medium text-white ring-1 ring-inset ring-black/20",children:[(0,r.jsx)(y.pn,{children:(0,r.jsxs)(y.u,{children:[(0,r.jsx)(y.aJ,{children:"EXCLUSIVE"}),(0,r.jsx)(y._v,{children:(0,r.jsx)("p",{children:"The whole node is dedicated to a single computeclass."})})]})}),(0,r.jsx)("div",{className:"offline flex-none rounded-full p-1",children:(0,r.jsx)("div",{role:"status",children:(0,r.jsx)("svg",{className:"w-4 h-4 me-0 text-white dark:text-white flex-shrink-0","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M12 1.5a5.25 5.25 0 0 0-5.25 5.25v3a3 3 0 0 0-3 3v6.75a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3v-6.75a3 3 0 0 0-3-3v-3c0-2.9-2.35-5.25-5.25-5.25Zm3.75 8.25v-3a3.75 3.75 0 1 0-7.5 0v3h7.5Z",clipRule:"evenodd"})})})})]}):(null==s?void 0:null===(b=s.spec)||void 0===b?void 0:null===(j=b.extraComputeClass)||void 0===j?void 0:j.length)?(0,r.jsxs)("dd",{className:"inline-flex items-center rounded-md bg-yellow-50 px-2 py-1 text-xs font-medium text-yellow-700 ring-1 ring-inset ring-yellow-600/20",children:[(0,r.jsx)(y.pn,{children:(0,r.jsxs)(y.u,{children:[(0,r.jsx)(y.aJ,{children:"SHARED"}),(0,r.jsx)(y._v,{children:(0,r.jsx)("p",{children:"The node has been allocated to one or more computeclasses."})})]})}),(0,r.jsx)("div",{className:"offline flex-none rounded-full p-1",children:(0,r.jsx)("div",{role:"status",children:(0,r.jsx)("svg",{className:"w-4 h-4 me-0 text-yellow-500 dark:text-yellow-400 flex-shrink-0","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"})})})})]}):(0,r.jsxs)("dd",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20",children:[(0,r.jsx)(y.pn,{children:(0,r.jsxs)(y.u,{children:[(0,r.jsx)(y.aJ,{children:"IDLE"}),(0,r.jsx)(y._v,{children:(0,r.jsx)("p",{children:"The node is not allocated to any jobs and is available for use."})})]})}),(0,r.jsx)("div",{className:"offline flex-none rounded-full p-1",children:(0,r.jsxs)("div",{role:"status",children:[(0,r.jsx)("svg",{className:"w-4 h-4 me-0 text-green-500 dark:text-green-400 flex-shrink-0","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"})}),(0,r.jsx)("span",{className:"sr-only",children:"..."})]})})]})})})})]},a)})})]})})})},e))]})})}):(0,r.jsx)("div",{className:"mt-2 ml-4",children:(0,r.jsx)(i.Z,{})})})})}function D(e){return(0,r.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M5 12h14"}),(0,r.jsx)("path",{d:"M12 5v14"})]})}var T=a(87420),B=a(34611),V=a(75355),F=a.n(V),z=a(80923),q=a(34209),W=a(23611),O=a(2187),X=e=>{let{workerdata:s}=e,a=(0,o.I0)(),t=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),[l,n]=(0,c.useState)(!0),[i,d]=(0,c.useState)({groupName:s.groupName||"",computeClass:s.computeClass||"",replicaCount:s.replicaCount||0}),u=(0,c.useRef)(i);(0,c.useEffect)(()=>{F()(i,u.current)||(x(),u.current=i)},[i,l,s]);let p=t.items.find(e=>"ray"===e.name),h=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels),x=()=>{console.log("submittedData RAY:",i);try{if(""===i.groupName&&""===i.computeClass&&0===i.replicaCount){m.ZP.error("Please update the Ray Worker parameters to save changes!");return}if(""!==i.groupName){let e={...p,spec:{...p.spec,rayParams:{...p.spec.rayParams,workers:p.spec.rayParams.workers.map(e=>e.groupName===s.groupName||""===e.groupName?{groupName:i.groupName,computeClass:i.computeClass,replicaCount:i.replicaCount}:e)}}},r=t.items.map(s=>"ray"===s.name?e:s);console.log("Updated data:",r),a((0,B.Gi)({items:[...r]}))}m.ZP.success("Ray Worker Params Updated!",{id:"unique-toast-id"})}catch(e){m.ZP.error("Something is wrong! Please try again.",{id:"rayWorkerParams"})}},v=e=>{let{name:s,value:a}=e.target;d(e=>({...e,[s]:a}))},g=e=>{let s=parseInt(i.replicaCount,10)||0;d(a=>({...a,[e]:Math.max(s-1,1)}))},f=e=>{let s=parseInt(i.replicaCount,10)||0;d(a=>({...a,[e]:s+1}))};return(0,r.jsx)(r.Fragment,{children:l&&(0,r.jsxs)("div",{className:"mt-4 pt-4 rounded-2xl border-4 border-dashed border-gray-900/25 px-6 py-10",children:[(0,r.jsx)("div",{className:"space-y-12",children:(0,r.jsx)("div",{className:"pb-2",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Worker Group"}),(0,r.jsx)("div",{className:"ml-3 flex h-7 items-center",children:(0,r.jsxs)("button",{type:"button",className:"rounded-md bg-white text-gray-400 hover:text-gray-500 outline ring-2 ring-indigo-500",onClick:()=>{try{if(""===s.groupName&&""===s.computeClass&&0===s.replicaCount){let e={...p,spec:{...p.spec,rayParams:{...p.spec.rayParams,workers:p.spec.rayParams.workers.slice(0,-1)}}},s=t.items.map(s=>"ray"===s.name?e:s);a((0,B.Gi)({items:s})),n(!1),m.ZP.success("Removed the worker!",{id:"rayWorkerParams"})}else if(1===p.spec.rayParams.workers.length)m.ZP.error("You cannot delete the last worker!",{id:"rayWorkerParams"});else if(""!==s.groupName){let e=p.spec.rayParams.workers.filter(e=>e.groupName!==s.groupName),r={...p,spec:{...p.spec,rayParams:{...p.spec.rayParams,workers:[...e]}}},l=t.items.map(e=>"ray"===e.name?r:e);a((0,B.Gi)({items:l})),n(!1),m.ZP.success("".concat(s.groupName," removed!"),{id:"rayWorkerParams"})}}catch(e){m.ZP.error("Something is wrong! Please reload and try again.",{id:"rayWorkerParams"})}},children:[(0,r.jsx)("span",{className:"sr-only",children:"Close"}),(0,r.jsx)(q.Z,{className:"h-6 w-6","aria-hidden":"true"})]})})]})})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-5",children:[(0,r.jsx)(z.Z,{label:"Group Name",popoverheader:"Name of the Group",popovercontent:(0,r.jsx)("p",{children:"Please provide the name of your Ray worker group. It is the specific group name you want to add."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("input",{name:"groupName",value:i.groupName,onChange:v,type:"text",placeholder:"Type your group name",autoComplete:"groupName",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-5",children:[(0,r.jsx)(z.Z,{label:"Select ComputeClass",popoverheader:"Select ComputeClass",popovercontent:(0,r.jsx)("p",{children:"Please select the labels for this service. This means the service will run in a particular node! If you want a custom label first add labels in a node!"})}),(0,r.jsx)("div",{className:"mt-2",children:h&&(0,r.jsx)("select",{name:"computeClass",value:i.computeClass,onChange:v,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",children:[...h].reverse().map(e=>(0,r.jsx)("option",{value:e,children:e},e))})})]})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-5",children:[(0,r.jsx)(z.Z,{label:"Number of workers",popoverheader:"Number of workers",popovercontent:(0,r.jsx)("p",{children:"Please provide the number of workers. It represents the number of replicas for your database."})}),(0,r.jsxs)("div",{className:"flex items-center justify-left mt-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>g("replicaCount"),className:"rounded-full bg-indigo-600 p-1 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 mr-4",children:(0,r.jsx)(W.Z,{className:"h-5 w-5","aria-hidden":"true"})}),(0,r.jsx)("input",{disabled:!0,name:"replicaCount",value:i.replicaCount,onChange:v,className:"w-16 text-center block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"}),(0,r.jsx)("button",{type:"button",onClick:()=>f("replicaCount"),className:"rounded-full bg-indigo-600 p-1 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 ml-4",children:(0,r.jsx)(O.Z,{className:"h-5 w-5","aria-hidden":"true"})})]})]})})]})})},G=e=>{var s,a,t,l,n,i,d,u,p,h,x,v,g;let{data:f}=e,y=(0,o.I0)(),j=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),b=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels),[N,w]=(0,c.useState)({computeClass:(null==f?void 0:null===(t=f.spec)||void 0===t?void 0:null===(a=t.rayParams)||void 0===a?void 0:null===(s=a.head)||void 0===s?void 0:s.computeClass)||"",name:(null==f?void 0:null===(i=f.spec)||void 0===i?void 0:null===(n=i.rayParams)||void 0===n?void 0:null===(l=n.image)||void 0===l?void 0:l.name)||"",tag:(null==f?void 0:null===(p=f.spec)||void 0===p?void 0:null===(u=p.rayParams)||void 0===u?void 0:null===(d=u.image)||void 0===d?void 0:d.tag)||""}),C=(0,c.useRef)(N);(0,c.useEffect)(()=>{F()(N,C.current)||(P(),C.current=N)},[N]);let P=()=>{let{name:e,tag:s,computeClass:a}=N;f.spec||(f.spec={}),f.spec.rayParams||(f.spec.rayParams={}),f.spec.rayParams.head||(f.spec.rayParams.head={}),f.spec.rayParams.image.name=e,f.spec.rayParams.image.tag=s,f.spec.rayParams.head.computeClass=a;let r=j.items.map(e=>e.name===f.name?f:e);y((0,B.Gi)({items:r})),m.ZP.success("Ray Parameters Updated!",{id:"rayParams"})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mt-4 pt-4 rounded-2xl border-4 border-dashed border-gray-900/25 px-6 py-10",children:[(0,r.jsx)("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Ray Head"}),b&&(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-5",children:[(0,r.jsx)(z.Z,{label:"Select ComputeClass",popoverheader:"Select ComputeClass",popovercontent:(0,r.jsx)("p",{children:"Please select the labels for this service. This means the service will run in a specific node! For custom labels, add them to a node first."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("select",{name:"computeClass",value:N.computeClass,onChange:e=>{let{name:s,value:a}=e.target;w(e=>({...e,[s]:a}))},className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",children:[...b].reverse().map(e=>(0,r.jsx)("option",{value:e,children:e},e))})})]})})]}),(null==f?void 0:null===(x=f.spec)||void 0===x?void 0:null===(h=x.rayParams)||void 0===h?void 0:h.workers)&&(null==f?void 0:null===(g=f.spec)||void 0===g?void 0:null===(v=g.rayParams)||void 0===v?void 0:v.workers.map((e,s)=>(0,r.jsx)(X,{workerdata:e},s))),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"mt-6 flex items-center justify-center gap-x-6",children:(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)("button",{type:"button",onClick:()=>{f.spec||(f.spec={}),f.spec.rayParams||(f.spec.rayParams={}),f.spec.rayParams.workers||(f.spec.rayParams.workers=[]),f.spec.rayParams.workers.push({groupName:"workergroup_".concat(f.spec.rayParams.workers.length+1),computeClass:b.length>0?b[b.length-1]:"",replicaCount:1});let e=j.items.map(e=>e.name===f.name?f:e);y((0,B.Gi)({items:e}))},className:"rounded-full bg-indigo-600 p-2 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:(0,r.jsx)(O.Z,{className:"h-5 w-5","aria-hidden":"true"})})})})}),(0,r.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,r.jsx)("div",{className:"mt-0 ml-8 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsx)("div",{className:"sm:col-span-5",children:(0,r.jsx)(z.Z,{label:"Add Ray Workers",popoverheader:"Add Ray Workers",popovercontent:(0,r.jsx)("p",{children:"Please click on the plus button to add ray workers. You can add multiple ray workers."})})})})})]})},M=e=>{var s,a;let{data:t,paramsName:l}=e;if(t.name.includes("ray"))return(0,r.jsx)(G,{data:t});let n=(0,o.I0)(),i=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels),d=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),[u,p]=(0,c.useState)({computeClass:(null==t?void 0:null===(a=t.spec)||void 0===a?void 0:null===(s=a[l])||void 0===s?void 0:s.computeClass)||""}),h=(0,c.useRef)(u);(0,c.useEffect)(()=>{F()(u,h.current)||(x(),h.current=u)},[u]);let x=()=>{try{let{computeClass:e}=u;t.spec||(t.spec={}),t.spec[l]||(t.spec[l]={}),t.spec[l].computeClass=e;let s=d.items.map(e=>e.name===t.name?t:e);n((0,B.Gi)({items:s})),m.ZP.success("Parameters Updated!",{id:"paramsName"})}catch(e){m.ZP.error("Something went wrong! Please try again.",{id:"paramsName"})}};return i?(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-5",children:[(0,r.jsx)(z.Z,{label:"Select ComputeClass",popoverheader:"Select ComputeClass",popovercontent:(0,r.jsx)("p",{children:"Please select the labels for this service. This means the service will run on a specific node! For custom labels, add them to a node first."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("select",{name:"computeClass",value:u.computeClass,onChange:e=>{let{name:s,value:a}=e.target;p(e=>({...e,[s]:a}))},className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",children:[...i].reverse().map(e=>(0,r.jsx)("option",{value:e,children:e},e))})})]})})}):null},Y=e=>{let{deployment:s,icon:a,description:t,children:l}=e;return(0,r.jsxs)("li",{className:"relative flex items-center space-x-4 py-4",children:[(0,r.jsxs)("div",{className:"min-w-0 flex-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-3",children:[(0,r.jsx)(a,{className:"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600","aria-hidden":"true"}),(0,r.jsx)("h2",{className:"min-w-0 text-sm font-semibold leading-6 text-gray-900",children:(0,r.jsx)("a",{href:"#",className:"flex gap-x-2",children:(0,r.jsxs)("span",{className:"whitespace-nowrap text-gray-900",children:[s.name,(0,r.jsx)("span",{className:"text-base text-rose-500",children:"*️"})]})})})]}),(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-x-2.5 text-xs leading-5 text-gray-400",children:[(0,r.jsx)("p",{className:"whitespace-nowrap truncate",children:t}),(0,r.jsx)("br",{})]})]}),l]},s.name)},H=a(70694),K=a(96764),$=e=>{let{deployment:s,children:a}=e;return(0,r.jsxs)(H.yo,{children:[(0,r.jsx)(H.aM,{asChild:!0,children:(0,r.jsxs)(x.z,{variant:"outline",children:["Edit Params"," ",(0,r.jsx)(K.Z,{className:"ml-2 -mr-0.5 h-5 w-5 flex-none text-gray-400","aria-hidden":"true"})]})}),(0,r.jsxs)(H.ue,{className:"overflow-auto",children:[(0,r.jsxs)(H.Tu,{children:[(0,r.jsxs)(H.bC,{children:["Edit ",s.name," values"]}),(0,r.jsx)(H.Ei,{children:"You can update these values and click update. These are current default values. If there is no value to update then it will be empty."})]}),(0,r.jsx)("div",{className:"grid gap-4 py-4 overflow-visible",children:a})]})]})},J=a(74859);let Q=e=>e.items.filter(e=>{if("true"===J.env.NEXT_PUBLIC_SNOWFLAKE){var s,a;return(null==e?void 0:null===(s=e.spec)||void 0===s?void 0:s.category)!=="databases"&&(null==e?void 0:null===(a=e.spec)||void 0===a?void 0:a.category)!=="mongodb"&&(null==e?void 0:e.name)!=="monitoring"}return!0}).sort((e,s)=>e.name<s.name?-1:e.name>s.name?1:0).map(e=>(0,r.jsx)(Y,{deployment:e,icon:(null==e?void 0:e.icon)||T.Z,description:(null==e?void 0:e.description)||"".concat(e.name," is a service of superduper required to run the application."),children:(0,r.jsx)($,{deployment:e,children:(0,r.jsx)(M,{data:e,paramsName:"".concat(e.name,"Params")})})},e.id));var ee=()=>{let e=(0,o.v9)(e=>e.environment.environmentLoadedValues),s=(0,o.v9)(e=>{var s;return null==e?void 0:null===(s=e.userInfo)||void 0===s?void 0:s.userInfoLoadedValues}),a=(0,o.I0)(),t=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels),l=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),d=(0,o.v9)(e=>e.deploymentName.deploymentNameLoadedValues.name);return((0,c.useEffect)(()=>{let r=async()=>{try{let r=await n.Z.get("/webui/apiserver/charts?deployment=".concat(d),{headers:{Accept:"application/json",Authorization:(0,U.Z)(s),superduper_reverse_proxy:J.env.NEXT_PUBLIC_API||e.NEXT_PUBLIC_API}});console.log("Charts API data:",r.data),a((0,B.Gi)(r.data))}catch(e){console.error("Error fetching Services API data")}};l||r()},[l,a]),l||t)?(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("div",{className:"bg-white px-2 py-5 sm:px-2",children:(0,r.jsxs)("ul",{role:"list",className:"divide-y divide-red/5",children:[l&&Q(l)," "]})})}):(0,r.jsxs)("div",{className:"mt-2 ml-4",children:[(0,r.jsx)(i.Z,{})," "]})},es=a(59260),ea=a(33453),er=a(49904);let et=e=>s=>s({type:er.s,payload:e});var el=a(68321),en=a(9551),ei=a(72940),eo=e=>{var s,a,t,l,n,i,d,u,p,h,x,v,g;let{data:f}=e,y=(0,o.I0)(),j=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),[b,N]=(0,c.useState)(!1),w=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels),[C,P]=(0,c.useState)({database:(null==f?void 0:null===(t=f.spec)||void 0===t?void 0:null===(a=t.mongodbParams)||void 0===a?void 0:null===(s=a.auth)||void 0===s?void 0:s.database)||"",username:(null==f?void 0:null===(i=f.spec)||void 0===i?void 0:null===(n=i.mongodbParams)||void 0===n?void 0:null===(l=n.auth)||void 0===l?void 0:l.username)||"",password:(null==f?void 0:null===(p=f.spec)||void 0===p?void 0:null===(u=p.mongodbParams)||void 0===u?void 0:null===(d=u.auth)||void 0===d?void 0:d.password)||"",replicaCount:(null==f?void 0:null===(x=f.spec)||void 0===x?void 0:null===(h=x.mongodbParams)||void 0===h?void 0:h.replicaCount)||0,computeClass:(null==f?void 0:null===(g=f.spec)||void 0===g?void 0:null===(v=g.mongodbParams)||void 0===v?void 0:v.computeClass)||""}),k=(0,c.useRef)(C),I=(0,c.useRef)(j);(0,c.useEffect)(()=>{F()(C,k.current)&&F()(j,I.current)||(console.log(),S(),k.current=C,I.current=j)},[C,j,el.V]);let S=()=>{try{let{database:e,username:s,password:a,replicaCount:r,computeClass:t}=C;f.spec.mongodbParams.auth.database=e,f.spec.mongodbParams.auth.username=s,f.spec.mongodbParams.auth.password=a,f.spec.mongodbParams.replicaCount=r,f.spec.mongodbParams.computeClass=t;let l=j.items.map(e=>e.name===f.name?f:e);y((0,B.Gi)({items:l})),m.ZP.success("MongoDB Params Updated!",{id:"unique-toast-id"})}catch(e){m.ZP.error("Something is wrong! Please try again.")}},Z=e=>{let{name:s,value:a}=e.target;P(e=>({...e,[s]:a}))};return(0,r.jsxs)("div",{className:"overflow-visible",children:[w&&j&&(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-8",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Select ComputeClass",popoverheader:"Select ComputeClass",popovercontent:(0,r.jsx)("p",{children:"Please select the labels for this service. This means the service will run in a particular node! If you want a custom label first add labels in a node!"})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("select",{name:"computeClass",value:C.computeClass,onChange:Z,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",children:[(0,r.jsx)("option",{value:"",children:"Select ComputeClass"}),[...w].map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})})]})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-8",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Database Name",popoverheader:"Name of the Database",popovercontent:(0,r.jsx)("p",{children:"Please provide the name of your database. It is the specific database you want to connect to."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("input",{name:"database",value:C.database,onChange:Z,type:"text",placeholder:"Type your database name",autoComplete:"database-name",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-8",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Username",popoverheader:"Database Username",popovercontent:(0,r.jsx)("p",{children:"Please provide your username here. It is used to connect to your database from your cluster."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("input",{name:"username",value:C.username,onChange:Z,type:"text",placeholder:"Type your database username",autoComplete:"username",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-8",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Password",popoverheader:"Database Password",popovercontent:(0,r.jsx)("p",{children:"Please provide your password here. It is used to authenticate connections to your database."})}),(0,r.jsxs)("div",{className:"mt-2 relative",children:[(0,r.jsx)("input",{id:"password",value:C.password,onChange:Z,type:b?"text":"password",placeholder:"Type your database password",autoComplete:"current-password",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 pr-10"}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>N(!b),className:"text-gray-400 hover:text-gray-500",children:b?(0,r.jsx)(en.Z,{className:"h-5 w-5","aria-hidden":"true"}):(0,r.jsx)(ei.Z,{className:"h-5 w-5","aria-hidden":"true"})})})]})]})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-8",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Replica Count",popoverheader:"Replica Count",popovercontent:(0,r.jsx)("p",{children:"Please provide the replica count. It represents the number of replicas for your database."})}),(0,r.jsxs)("div",{className:"flex items-center justify-left mt-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{P(e=>({...e,replicaCount:Math.max(e.replicaCount-1,1)}))},className:"rounded-full bg-indigo-600 p-1 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 mr-4",children:(0,r.jsx)(W.Z,{className:"h-5 w-5","aria-hidden":"true"})}),(0,r.jsx)("input",{disabled:!0,name:"replicaCount",value:C.replicaCount,onChange:Z,type:"number",className:"w-16 text-center block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"}),(0,r.jsx)("button",{type:"button",onClick:()=>{P(e=>({...e,replicaCount:e.replicaCount+1}))},className:"rounded-full bg-indigo-600 p-1 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 ml-4",children:(0,r.jsx)(O.Z,{className:"h-5 w-5","aria-hidden":"true"})})]})]})})]})},ed=()=>{let e=(0,o.I0)(),s=(0,o.v9)(e=>e.deployment.deploymentLoadedValues),a=a=>{let{name:r,value:t}=a.target;e(et({...s,databackendType:"haveDatabase",[r]:t}))};return(0,r.jsx)(r.Fragment,{children:s?(0,r.jsx)("div",{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mt-2 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Database Connection URI",popoverheader:"Database Connection URI",popovercontent:(0,r.jsx)("p",{children:"Here you put the connection string to your database. So, that we can connect to it. It's the full connection string."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("input",{id:"database_uri",name:"databaseURI",type:"text",placeholder:"<your-database-uri>",autoComplete:"database_uri",value:s.databaseURI,onChange:a,className:"block w-2/3 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Metadata Store URI",popoverheader:"Metadata Store URI",popovercontent:(0,r.jsx)("p",{children:"Here you put a connection string of your database. So, that it could be used as metadata store. Otherwise, you can use the same as metadata store."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("input",{id:"metadata-store-uri",name:"metadataStoreURI",type:"text",placeholder:"<your-database-uri>",autoComplete:"metadata-store-uri",value:s.metadataStoreURI,onChange:a,className:"block w-2/3 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]})}),(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Artifact Store URI",popoverheader:"Artifact Store URI",popovercontent:(0,r.jsx)("p",{children:"Artifact Store is a place where we store the artifacts. You can use the same as artifact store."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("input",{id:"artifact_database_uri",name:"artifactStoreURI",type:"text",placeholder:"<your-database-uri>",autoComplete:"artifact_database_uri",value:s.artifactStoreURI,onChange:a,className:"block w-2/3 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]})})]})}):(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(i.Z,{})})})};function ec(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return s.filter(Boolean).join(" ")}var eu=()=>{var e;let s=(0,o.I0)(),a=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),t=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels),l=(0,o.v9)(e=>e.deployment.deploymentLoadedValues),[n,d]=(0,c.useState)("deployDatabase"),[u,m]=(0,c.useState)({databaseURI:"",databaseType:"",metadataStoreURI:"",artifactStoreURI:""});return(0,c.useEffect)(()=>{s(et({databackendType:n,...u}))},[u,n,s,a]),(0,r.jsx)(r.Fragment,{children:l&&t?(0,r.jsxs)("div",{children:[(0,r.jsxs)(es.E,{value:l.databackendType,onChange:d,children:[(0,r.jsx)(es.E.Label,{className:"text-base font-semibold leading-6 text-gray-900"}),(0,r.jsx)("div",{className:"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-3 sm:gap-x-4",children:[{id:"deployDatabase",title:"Deploy a database",description:"We can deploy a database for you, and you can start using it right away.",users:"Deploy database",disabled:!1,active:!0},{id:"haveDatabase",title:"Connect existing database",description:"If you have a database, select this option and add the uri below.",users:"Host existing data",disabled:!1,active:!1}].map(e=>(0,r.jsx)(es.E.Option,{disabled:e.disabled,value:e.id,className:e=>{let{checked:s,active:a}=e;return ec(s?"border-transparent":"border-gray-300",a?"border-indigo-600 ring-2 ring-indigo-600":"","relative flex cursor-pointer rounded-lg border bg-white p-4 shadow-sm focus:outline-none")},children:s=>{let{checked:a,active:t}=s;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"flex flex-1",children:(0,r.jsxs)("span",{className:"flex flex-col",children:[(0,r.jsx)(es.E.Label,{as:"span",className:"block text-sm font-medium text-gray-900",children:e.title}),(0,r.jsx)(es.E.Description,{as:"span",className:"mt-1 flex items-center text-sm text-gray-500",children:e.description}),(0,r.jsx)(es.E.Description,{as:"span",className:"mt-6 text-sm font-medium text-gray-900",children:e.users})]})}),(0,r.jsx)(ea.Z,{className:ec(a?"":"invisible","h-5 w-5 text-indigo-600"),"aria-hidden":"true"}),(0,r.jsx)("span",{className:ec(t?"border":"border-2",a?"border-indigo-600":"border-transparent","pointer-events-none absolute -inset-px rounded-lg"),"aria-hidden":"true"})]})}},e.id))})]}),(0,r.jsx)("br",{}),"deployDatabase"===n&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)("label",{htmlFor:"database-type",className:"block text-sm font-medium leading-6 text-gray-900",children:"Select Database"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("select",{id:"database-type",name:"databaseType",autoComplete:"database-type",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6",value:u.databaseType,onChange:e=>{let{name:s,value:a}=e.target;m(e=>({...e,[s]:a}))},children:[(0,r.jsx)("option",{value:"",children:"Select Database"}),(null==a?void 0:a.items)&&(null==a?void 0:a.items.filter(e=>{var s;return(null==e?void 0:null===(s=e.spec)||void 0===s?void 0:s.category)==="databases"}).map(e=>e.name).map(e=>(0,r.jsx)("option",{value:e,children:e.toLowerCase()},e)))]})}),a&&"mongodb"==u.databaseType&&(null==a?void 0:null===(e=a.items)||void 0===e?void 0:e.map((e,s)=>(0,r.jsx)(r.Fragment,{children:"mongodb"==e.name&&(0,r.jsx)(eo,{data:e},s)})))]})}),"haveDatabase"===n&&(0,r.jsx)(ed,{})]}):(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(i.Z,{})})})},em=a(64520),ep=a(81695),eh=a(72513),ex=a(98348),ev=e=>{var s,a;let{data:t}=e,l=(0,o.I0)(),n=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),i=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels),[d,u]=(0,c.useState)({computeClass:(null==t?void 0:null===(a=t.spec)||void 0===a?void 0:null===(s=a.monitoringParams)||void 0===s?void 0:s.computeClass)||""}),m=(0,c.useRef)(d);(0,c.useEffect)(()=>{F()(d,m.current)||(p(),m.current=d)},[d]),(0,o.v9)(e=>e.nodegroups.nodeLoadedValues);let p=()=>{if(n&&n.items){var e,s;let a=(e=n.items,s=d.computeClass,function e(a){if(Array.isArray(a))return a.map(s=>e(s));if("object"!=typeof a||null===a)return a;for(let r in a)a[r]=e(a[r]),"computeClass"===r&&(a[r]=s);return a}(e));l((0,B.Gi)({items:a}))}else console.error("chartsgroups or chartsgroups.items is undefined")};return(0,r.jsx)("div",{children:i&&(0,r.jsx)("div",{className:"mt-1 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Select Default ComputeClass for services",popoverheader:"Select Default ComputeClass",popovercontent:(0,r.jsx)("p",{children:"Please select the default compute class for all of the services and databases. If you have workloads that have unique hardware requirements, such as performing machine learning or AI tasks, needing specific CPU platforms and architecture, or needing performance isolation among users, Superduper offers compute classes. These compute classes are a curated subset of the infrastructure machine types. You can assign a compute class to a workload to ensure that it runs on the right type of machine."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("select",{name:"computeClass",value:d.computeClass,onChange:e=>{let{name:s,value:a}=e.target;u(e=>({...e,[s]:a}))},className:"block w-2/3 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",children:[(0,r.jsx)("option",{value:"",children:"Select Default ComputeClass for services"},"defaults"),i&&i.length>0?[...i].map(e=>e&&(0,r.jsx)("option",{value:e,children:e},e)):[(0,r.jsx)("option",{value:"default",children:"default"},"default")]]})})]})})})},eg=a(45696),ef=a.n(eg);function ey(e){let s=new Set;return e&&Array.isArray(e.items)?(e.items.forEach(e=>{var a,r,t,l,n,i;let{spec:o={}}=e;if(null===(a=o.jupyterhubParams)||void 0===a?void 0:a.image){let{name:e,tag:a}=o.jupyterhubParams.image;s.add("".concat(e,":").concat(a))}if(null===(r=o.restParams)||void 0===r?void 0:r.image){let{name:e,tag:a}=o.restParams.image;s.add("".concat(e,":").concat(a))}if(null===(t=o.vectorsearchParams)||void 0===t?void 0:t.image){let{name:e,tag:a}=o.vectorsearchParams.image;s.add("".concat(e,":").concat(a))}if(null===(l=o.rayParams)||void 0===l?void 0:l.image){let{name:e,tag:a}=o.rayParams.image;s.add("".concat(e,":").concat(a))}if(null===(n=o.cdcParams)||void 0===n?void 0:n.image){let{name:e,tag:a}=o.cdcParams.image;s.add("".concat(e,":").concat(a))}if(null===(i=o.schedulerParams)||void 0===i?void 0:i.image){let{name:e,tag:a}=o.schedulerParams.image;s.add("".concat(e,":").concat(a))}}),Array.from(s)):(console.warn("Data is undefined or data.items is not an array"),[])}var ej=e=>{var s,a;let{data:t}=e,l=(0,o.I0)(),n=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),i=(0,o.v9)(e=>e.nodegroups.nodeUniqueLabels),[d,u]=(0,c.useState)({computeClass:(null==t?void 0:null===(a=t.spec)||void 0===a?void 0:null===(s=a.monitoringParams)||void 0===s?void 0:s.computeClass)||""});return(0,r.jsx)("div",{children:i&&(0,r.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:(0,r.jsxs)("div",{className:"sm:col-span-3",children:[(0,r.jsx)(z.Z,{label:"Update Default Image",popoverheader:"Update Default Image",popovercontent:(0,r.jsx)("p",{children:"Please select the default Docker image for all services. All our services use the same Docker image."})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("input",{name:"imageandtag",value:ey(n)&&ey(n).length>0?ey(n)[0]:"Enter image and tag",onChange:e=>{u(s=>({...s,[e.target.name]:e.target.value}));try{let{value:s}=e.target,{name:a,tag:r}=function(e){let s=e.indexOf(":");return -1===s?{name:e,tag:null}:{name:e.substring(0,s),tag:e.substring(s+1)}}(s),t=n.items.map(e=>{for(let s of Object.keys(e.spec))s.endsWith("Params")&&e.spec[s].image&&(e.spec[s].image.name=a,e.spec[s].image.tag=r);return e});console.log("Updated items:",t),l((0,B.Gi)({items:t})),m.ZP.success("Image parameters updated successfully!",{id:"updateImageParams"})}catch(e){m.ZP.error("Something went wrong! Please try again.",{id:"updateImageParamsError"}),console.error("Update failed:",e)}},className:"block w-2/3 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",placeholder:ey(n)&&ey(n).length>0?ey(n)[0]:"Enter image and tag"})})]})})})},eb=a(13333),eN=a(95417),ew=a(37727),eC=a(82869);let eP=e=>s=>s({type:eC.I,payload:e});var ek=e=>{let{data:s}=e,a=(0,o.I0)(),[t,l]=(0,c.useState)([]),n=(0,c.useRef)(null),i=(0,o.v9)(e=>e.extraEnvVars),d=(e,s,r)=>{let t=[...i];t[e][s]=r.target.value,a(eP(ef()(t)))},u=e=>{let s=i.filter((s,a)=>a!==e);a(eP(ef()(s))),l(t.filter((s,a)=>a!==e))},p=e=>{l(s=>{let a=[...s];return a[e]=!a[e],a})};return i&&Array.isArray(i)?(0,r.jsxs)("div",{children:[i.map((e,s)=>(0,r.jsx)("div",{className:"relative mt-5 grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-8",children:(0,r.jsxs)("div",{className:"sm:col-span-1 grid grid-cols-2 gap-x-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(z.Z,{label:"Key",popoverheader:"Key",popovercontent:(0,r.jsx)("p",{children:"Enter the key for the environment variable."})}),(0,r.jsx)("input",{name:"name-".concat(s),value:e.name,onChange:e=>d(s,"name",e),className:"mt-2 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",placeholder:"Enter key"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(z.Z,{label:"Value",popoverheader:"Value",popovercontent:(0,r.jsx)("p",{children:"Enter the value for the environment variable."})}),(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-4 w-3xl max-w-md",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)("input",{name:"value-".concat(s),value:e.value,type:t[s]?"text":"password",onChange:e=>d(s,"value",e),placeholder:"Enter value",className:"block w-3xl rounded-md border-0 py-1.5 pr-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 cursor-pointer",onClick:()=>p(s),children:t[s]?(0,r.jsx)(en.Z,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):(0,r.jsx)(ei.Z,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),(0,r.jsx)(x.z,{variant:"ghost",onClick:()=>u(s),className:"bg-black text-white hover:bg-red-500 hover:text-white dark:hover:bg-red-900 px-2",children:(0,r.jsx)(eb.Z,{className:"h-4 w-4"})})]})]})]})},s)),(0,r.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,r.jsxs)(x.z,{onClick:()=>{a(eP(ef()([...i,{name:"",value:""}]))),l([...t,!1])},children:[(0,r.jsx)(eN.Z,{className:"mr-2 h-4 w-4"}),"Add env variables"]}),(0,r.jsxs)(x.z,{onClick:()=>n.current.click(),children:[(0,r.jsx)(ew.Z,{className:"mr-2 h-4 w-4"}),"Upload Env File"]}),(0,r.jsx)("input",{ref:n,type:"file",onChange:e=>{let s=e.target.files[0];try{if(s){let e=new FileReader;e.onload=e=>{let s=e.target.result.split("\n").map(e=>{let[s,a]=e.split("=").map(e=>e.trim());return{name:s,value:a}}).filter(e=>e.name&&e.value);a(eP(ef()([...i,...s]))),l(e=>[...e,...Array(s.length).fill(!1)])},e.readAsText(s)}}catch(e){console.error(e),m.ZP.error("Failed to parse the file. Please try again with .env or .txt format.")}},style:{display:"none"}})]})]}):null};a(67430),a(78999);var eI=a(46346),eS=a(288),eZ=a(74859);function eR(){let e=(0,o.v9)(e=>e.environment.environmentLoadedValues),s=(0,o.v9)(e=>{var s;return null==e?void 0:null===(s=e.userInfo)||void 0===s?void 0:s.userInfoLoadedValues}),a=(0,ep.useRouter)(),t=(0,o.v9)(e=>e.deploymentName.deploymentNameLoadedValues.name),l=(0,o.v9)(e=>e.chartsgroups.chartsLoadedValues),i=(0,o.v9)(e=>e.nodegroups.nodeLoadedValues),d=(0,o.v9)(e=>e.deployment.deploymentLoadedValues),p=(0,o.v9)(e=>e.extraEnvVars),[h,x]=(0,c.useState)("Something went wrong while creating the deployment. Please try again later."),[v,g]=(0,c.useState)(!1),[y,j]=(0,c.useState)(!1),[b,N]=(0,c.useState)(!1),[w,C]=(0,c.useState)(!1),P=async()=>{let a;try{if("true"==eZ.env.NEXT_PUBLIC_SNOWFLAKE&&(null==d?void 0:d.databaseURI)===""){m.ZP.error("Database URI is missing.",{duration:5e3});return}window.scrollTo({top:0,behavior:"smooth"});let r={name:t,spec:{fake:!!t.startsWith("fake"),dataEndpoints:{artifactStore:{backendType:"",connectionURI:(null==d?void 0:d.artifactStoreURI)||""},dataStore:{backendType:"",connectionURI:(null==d?void 0:d.databaseURI)||""},metadataStore:{backendType:"",connectionURI:(null==d?void 0:d.metadataStoreURI)||""},extraEnvVars:p||[]},nodeGroupList:i.items.map(e=>{let{status:s,...a}=e;return a}).filter(e=>{var s;return(null==e?void 0:null===(s=e.spec)||void 0===s?void 0:s.extraComputeClass)&&e.spec.extraComputeClass.length>0}),serviceList:l.items.map(e=>{let{status:s,...a}=e;return a}).filter(e=>{if("true"===eZ.env.NEXT_PUBLIC_SNOWFLAKE){var s;return(null==e?void 0:null===(s=e.spec)||void 0===s?void 0:s.category)!=="databases"&&(null==e?void 0:e.name)!=="mongodb"&&(null==e?void 0:e.name)!=="monitoring"}return!0}).filter(e=>{let{name:s}=e;return!("mongodb"===s&&((null==d?void 0:d.artifactStoreURI)||(null==d?void 0:d.databaseURI)||(null==d?void 0:d.metadataStoreURI)))})}};C(!0),console.log("\uD83D\uDC49 REQUEST DATA",r);let o={headers:{Accept:"application/json","Content-Type":"application/json",Authorization:(0,U.Z)(s),superduper_reverse_proxy:eZ.env.NEXT_PUBLIC_API||e.NEXT_PUBLIC_API}};g(!0),a=m.ZP.loading("Deployment in progress...",{duration:1/0}),await new Promise(e=>setTimeout(e,3e3));let c=await n.Z.post("/webui/apiserver/deployments",r,o);console.log("RESULT:",c.data),await new Promise(e=>setTimeout(e,5e3)),m.ZP.dismiss(a),window.location.assign("/webui?deployment=done&query=1m"),m.ZP.success("Deployment successful!",{icon:"\uD83D\uDE80",duration:5e3})}catch(e){var r,o;a&&m.ZP.dismiss(a),e.response&&"true"===eZ.env.NEXT_PUBLIC_SNOWFLAKE&&200!==e.response.status&&400!==e.response.status?(console.error("Deployment Form Submission Error:",e.response.data),x((null===(r=e.response)||void 0===r?void 0:r.data)||e.message)):(console.error("Deployment Form Submission Error:",e),x((null===(o=e.response)||void 0===o?void 0:o.data)||e.message)),N(!0),m.ZP.error("Deployment failed. Please try again.",{duration:5e3})}finally{C(!1),g(!1),j(!1)}},k=async()=>{let r;try{if("true"==eZ.env.NEXT_PUBLIC_SNOWFLAKE&&(null==d?void 0:d.databaseURI)===""){m.ZP.error("Database URI is missing.",{duration:5e3});return}let o={name:t,spec:{fake:!!t.startsWith("fake"),dataEndpoints:{artifactStore:{backendType:"",connectionURI:(null==d?void 0:d.artifactStoreURI)||""},dataStore:{backendType:"",connectionURI:(null==d?void 0:d.databaseURI)||""},metadataStore:{backendType:"",connectionURI:(null==d?void 0:d.metadataStoreURI)||""},extraEnvVars:p||[]},nodeGroupList:i.items.map(e=>{let{status:s,...a}=e;return a}).filter(e=>{var s;return(null==e?void 0:null===(s=e.spec)||void 0===s?void 0:s.extraComputeClass)&&e.spec.extraComputeClass.length>0}),serviceList:l.items.map(e=>{let{status:s,...a}=e;return a}).filter(e=>{let{name:s}=e;return!("mongodb"===s&&((null==d?void 0:d.artifactStoreURI)||(null==d?void 0:d.databaseURI)||(null==d?void 0:d.metadataStoreURI)))}),serviceList:l.items.map(e=>{let{status:s,...a}=e;return a}).filter(e=>{if("true"===eZ.env.NEXT_PUBLIC_SNOWFLAKE){var s;return(null==e?void 0:null===(s=e.spec)||void 0===s?void 0:s.category)!=="databases"&&(null==e?void 0:e.name)!=="mongodb"&&(null==e?void 0:e.name)!=="monitoring"}return!0}).filter(e=>{let{name:s}=e;return!("mongodb"===s&&((null==d?void 0:d.artifactStoreURI)||(null==d?void 0:d.databaseURI)||(null==d?void 0:d.metadataStoreURI)))})}};console.log("\uD83D\uDC49 REQUEST DATA",o),g(!0),r=m.ZP.loading("Retrying deployment...",{duration:1/0}),await new Promise(e=>setTimeout(e,5e3));let c={headers:{Accept:"application/json","Content-Type":"application/json",Authorization:(0,U.Z)(s),superduper_reverse_proxy:eZ.env.NEXT_PUBLIC_API||e.NEXT_PUBLIC_API}},u=await n.Z.post("/webui/apiserver/deployments",o,c);console.log("RESULT:",u.data),await new Promise(e=>setTimeout(e,5e3)),m.ZP.dismiss(r),m.ZP.success("Deployment is successful.",{duration:5e3}),a.push("/webui?deployment=done&query=1m",void 0,{shallow:!1}),j(!1)}catch(e){if(r&&m.ZP.dismiss(r),e.response&&200!==e.response.status&&400!==e.response.status)console.error("Deployment Form Submission Error:",e.response.data),a.push("/webui?deployment=done&query=1m",void 0,{shallow:!1}),m.ZP.success("Deployment successful!",{icon:"\uD83D\uDE80",duration:5e3});else{var o;console.error("Deployment Form Submission Error:",e),x((null===(o=e.response)||void 0===o?void 0:o.data)||e.message),N(!0),m.ZP.error("Deployment retry failed. Please try again.",{duration:5e3})}}finally{g(!1),j(!1)}};return v?(0,r.jsx)(eS.Z,{}):(0,r.jsxs)(r.Fragment,{children:[" ",(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"pb-2",children:[(0,r.jsx)("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Step 1: Set Compute Classes"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"ComputeClass enables users to influence the scheduling of Services on nodes based on specific criteria such as hardware capabilities, geographic location, or other custom requirements."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(_,{}),(0,r.jsx)(ev,{}),(0,r.jsx)("br",{})]}),(0,r.jsxs)("div",{className:"border-b border-gray-900/10 pb-12",children:[(0,r.jsx)("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Step 2: Add Databackend"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"At first you have to add a database to your deployment. You can update the parameters below. We will deploy and handle the rest."}),(0,r.jsx)("br",{}),"true"!==eZ.env.NEXT_PUBLIC_SNOWFLAKE?(0,r.jsx)(eu,{}):(0,r.jsx)(ed,{})]}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{className:"pb-4",children:[(0,r.jsx)("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Step 3: Define Parameters"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"Update the services you want to install on your deployment. You can click on the service to edit the configuration."}),(0,r.jsxs)("div",{style:{marginLeft:"-1.5rem!important"},children:[(0,r.jsx)(ej,{}),(0,r.jsx)(ek,{}),(0,r.jsx)(ee,{})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-x-6",children:[(0,r.jsx)(u.default,{href:"/webui",children:(0,r.jsx)("button",{type:"button",className:"text-sm font-semibold leading-6 text-gray-900",children:"Cancel"})}),(0,r.jsxs)(em.aR,{children:[(0,r.jsx)(em.vW,{className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Start Deployment"}),(0,r.jsxs)(em._T,{children:[(0,r.jsxs)(em.fY,{children:[(0,r.jsx)(em.f$,{children:"Start creating deployment now..."}),(0,r.jsx)(em.yT,{children:"This will create a deployment and it will take some time to finish. Please be patient. Do you want to continue?"})]}),(0,r.jsxs)(em.xo,{children:[(0,r.jsx)(em.le,{children:"Cancel"}),(0,r.jsx)(em.OL,{onClick:()=>{j(!0),P()},children:"Continue"})]})]})]})]}),(0,r.jsx)(em.aR,{open:y,children:(0,r.jsx)(em._T,{children:(0,r.jsxs)(em.fY,{children:[(0,r.jsx)(em.f$,{children:"Started deployment process..."}),(0,r.jsx)(em.yT,{children:"This initiates a deployment process that may take some time. Please wait patiently. You'll be redirected to the dashboard once it's complete."}),(0,r.jsx)("br",{}),(0,r.jsx)(ex.O,{})]})})}),(0,r.jsx)(em.aR,{open:b,children:(0,r.jsxs)(em._T,{children:[(0,r.jsxs)(em.fY,{children:[(0,r.jsx)(em.f$,{children:"Deployment Failed"}),(0,r.jsx)(em.yT,{children:(0,r.jsxs)(eh.bZ,{variant:"destructive",children:[(0,r.jsx)(f.LPM,{className:"h-4 w-4"}),(0,r.jsx)(eh.Cd,{children:"Error"}),(0,r.jsx)(eI.x,{className:"scrollbar-visible h-[200px] w-full mt-2 pr-4",children:(0,r.jsx)(eh.X,{children:h})})]})})]}),(0,r.jsxs)(em.xo,{children:[(0,r.jsx)(em.le,{onClick:()=>{N(!1),j(!1)},children:"Cancel"}),(0,r.jsx)(em.OL,{onClick:()=>{j(!0),N(!1),k()},children:"Retry Now"})]})]})})]})]})}var eE=a(74859);function eU(){let e=(0,o.v9)(e=>e.environment.environmentLoadedValues),s=(0,o.v9)(e=>{var s;return null==e?void 0:null===(s=e.userInfo)||void 0===s?void 0:s.userInfoLoadedValues}),a=async a=>(await n.Z.get(a,{headers:{Accept:"application/json",Authorization:(0,U.Z)(s),superduper_reverse_proxy:eE.env.NEXT_PUBLIC_API||e.NEXT_PUBLIC_API}})).data,{data:t,error:c}=(0,l.ZP)("/webui/apiserver/health",a,{refreshInterval:0,revalidateOnFocus:!1,revalidateOnReconnect:!1,shouldRetryOnError:!1});return t||c?c?(console.log("Error",c),(0,r.jsx)(d.Z,{header:"API Server is currently unavailable"})):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(eR,{})}):(0,r.jsx)(i.Z,{times:6})}var eL=a(57649),eA=(0,a(4867).N)(function(){return(0,r.jsx)(eL.Z,{children:(0,r.jsx)(t.Z,{activeNavItem:"/webui",children:(0,r.jsx)("main",{className:"py-10",children:(0,r.jsx)("div",{className:"px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"mx-auto max-w-7xl",children:(0,r.jsx)(eU,{})})})})})})})})},288:function(e,s,a){"use strict";a.d(s,{Z:function(){return f}});var r=a(27573),t=a(7653),l=a(12198),n=a(34527),i=a(82440),o=a(66465),d=a(53896),c=a(86288),u=a(13908),m=a(81695),p=a(7109),h=a(412),x=a(70790),v=a(74859);let g=[{key:"initializing",icon:l.Z,label:"Initializing",duration:3e3},{key:"building",icon:n.Z,label:"Building",duration:3e3},{key:"deploying",icon:i.Z,label:"Deploying",duration:3e3},{key:"success",icon:o.Z,label:"Success",duration:3e3}];function f(){let[e,s]=(0,t.useState)("initializing"),[a,l]=(0,t.useState)(0),n=(0,h.v9)(e=>e.environment.environmentLoadedValues),i=(0,h.v9)(e=>{var s;return null==e?void 0:null===(s=e.userInfo)||void 0===s?void 0:s.userInfoLoadedValues}),o=(0,m.useRouter)(),f=(0,h.v9)(e=>e.deploymentName.deploymentNameLoadedValues.name),y=async e=>(await u.Z.get(e,{headers:{Accept:"application/json",Authorization:(0,p.Z)(i),superduper_reverse_proxy:v.env.NEXT_PUBLIC_API||n.NEXT_PUBLIC_API}})).data,{data:j,error:b}=(0,x.ZP)("/webui/apiserver/deployments/".concat(f,"/"),y,{refreshInterval:0,revalidateOnFocus:!1,revalidateOnReconnect:!1,shouldRetryOnError:!1});(0,t.useEffect)(()=>{j&&o.push("/webui?deployment=done&query=1m",void 0,{shallow:!0})},[j]),(0,t.useEffect)(()=>{N()},[]);let N=()=>{s("initializing"),l(0)};return(0,t.useEffect)(()=>{if("success"===e)return;let a=g.find(s=>s.key===e),r=g.findIndex(s=>s.key===e);l(0);let t=setInterval(()=>{l(e=>{let s=e+100/(a.duration/100);return s>=100?100:s})},100),n=setTimeout(()=>{r<g.length-1?s(g[r+1].key):s("success")},a.duration);return()=>{clearInterval(t),clearTimeout(n)}},[e]),(0,r.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,r.jsxs)(c.Zb,{className:"w-full max-w-4xl",children:[(0,r.jsxs)(c.Ol,{className:"text-center",children:[(0,r.jsx)(c.ll,{className:"text-3xl font-bold",children:"Deployment Status"}),(0,r.jsx)("p",{className:"text-muted-foreground mt-2",children:"Tracking progress of your deployment"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-8",children:[(0,r.jsxs)("div",{className:"w-full md:w-1/3 md:border-r md:pr-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Deployment Stages"}),(0,r.jsx)("ul",{className:"space-y-4",children:g.map(s=>{let a=s.icon,t=s.key===e,l=g.findIndex(s=>s.key===e)>g.findIndex(e=>e.key===s.key);return(0,r.jsxs)("li",{className:"flex items-center space-x-3 ".concat(t?"text-blue-600 font-medium":l?"text-green-600":"text-gray-500"),children:[(0,r.jsx)(a,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:s.label}),l&&(0,r.jsx)(d.Z,{className:"w-4 h-4 text-green-600"})]},s.key)})})]}),(0,r.jsxs)("div",{className:"w-full md:w-2/3 md:pl-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Progress"}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center mb-8",children:["success"===e?(0,r.jsx)(d.Z,{className:"text-green-500 w-24 h-24 mb-4"}):(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("svg",{className:"w-24 h-24",viewBox:"0 0 100 100",children:[(0,r.jsx)("circle",{className:"text-gray-200",strokeWidth:"8",stroke:"currentColor",fill:"transparent",r:"42",cx:"50",cy:"50"}),(0,r.jsx)("circle",{className:"text-blue-600",strokeWidth:"8",strokeDasharray:264,strokeDashoffset:264-a/100*264,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"42",cx:"50",cy:"50"})]}),(0,r.jsxs)("span",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-xl font-semibold",children:[Math.round(a),"%"]})]}),(0,r.jsx)("p",{className:"text-center text-lg font-medium mt-4",children:(()=>{switch(e){case"initializing":return"Deployment ongoing, initializing...";case"building":return"Deployment ongoing, building files...";case"deploying":return"Deployment ongoing, finalizing production setup...";case"success":return"Deployment ongoing, almost live!";default:return"Deployment ongoing, wrapping up..."}})()})]})]})]})})]})})}},4216:function(e,s,a){"use strict";a.d(s,{X:function(){return o}});var r=a(27573),t=a(7653),l=a(92999),n=a(85688),i=a(18580);let o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.fC,{ref:s,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...t,children:(0,r.jsx)(l.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(n.nQG,{className:"h-4 w-4"})})})});o.displayName=l.fC.displayName},4482:function(e,s,a){"use strict";a.d(s,{_v:function(){return c},aJ:function(){return d},pn:function(){return i},u:function(){return o}});var r=a(27573),t=a(7653),l=a(23098),n=a(18580);let i=l.zt,o=l.fC,d=l.xz,c=t.forwardRef((e,s)=>{let{className:a,sideOffset:t=4,...i}=e;return(0,r.jsx)(l.VY,{ref:s,sideOffset:t,className:(0,n.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})});c.displayName=l.VY.displayName},4867:function(e,s,a){"use strict";a.d(s,{N:function(){return r}}),a(27573),a(81695),a(7653),a(412),a(57649),a(39e3),a(74531),a(74859);let r=e=>(e.displayName||e.name,e)}},function(e){e.O(0,[5458,7441,3296,8320,8374,3908,5383,6340,6600,384,8209,9115,9345,6444,3098,5435,9275,935,4848,2698,1293,1528,1744],function(){return e(e.s=43386)}),_N_E=e.O()}]);