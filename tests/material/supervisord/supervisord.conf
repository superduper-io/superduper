[supervisord]

logfile=logs/supervisord.log

[program:linear_algebra]

command=/bin/bash -c "python3 -m superduperdb.servers.linear_algebra $(cat config.json | jq .linear_algebra.port)"
process_name=%(program_name)s_%(process_num)s
numprocs=1
stdout_logfile=logs/linear_algebra.out
stderr_logfile=logs/linear_algebra.out
autorestart=false
startretries=1

[program:model_server]

command=/bin/bash -c "python3 -m superduperdb.servers.model_server $(cat config.json | jq .model_server.port)"
process_name=%(program_name)s_%(process_num)s
numprocs=1
stdout_logfile=logs/model_server.out
stderr_logfile=logs/model_server.out
autorestart=false
startretries=1

[program:worker]

command=/bin/bash -c "rq worker -w rq_worker.py -v --url redis://:@localhost:$(cat config.json | jq .redis.port)"
process_name=%(program_name)s_%(process_num)s
numprocs=1
stdout_logfile=logs/worker_%(process_num)s.out
stderr_logfile=logs/worker_%(process_num)s.out
autorestart=false
startretries=1

[program:redis]

command=/bin/bash -c "redis-server --port $(cat config.json | jq .redis.port)"
process_name=%(program_name)s_%(process_num)s
numprocs=1
stdout_logfile=logs/redis.out
stderr_logfile=logs/redis.out
autorestart=false
startretries=1

[program:notebook]
command=/bin/bash -c "python3 -m jupyter notebook --port=$(cat config.json | jq .notebook.port) --ip=$(cat config.json | jq .notebook.ip) --NotebookApp.token=$(cat config.json | jq .notebook.token) --allow-root"
process_name=%(program_name)s_%(process_num)s.out
numprocs=1
stdout_logfile=logs/notebook.out
stderr_logfile=logs/notebook.out
autorestart=true
startretries=1
